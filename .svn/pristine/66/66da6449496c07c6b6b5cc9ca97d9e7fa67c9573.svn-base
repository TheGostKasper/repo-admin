function init(){navigator.geolocation.getCurrentPosition(function(e){coords={latitude:e.coords.latitude,longitude:e.coords.longitude},initMap(coords)})}function initMap(e){var t,o=new google.maps.Map(document.getElementById("map"),{zoom:18,center:new google.maps.LatLng(e.latitude,e.longitude),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,streetViewControl:!1});t=new google.maps.Marker({position:new google.maps.LatLng(e.latitude,e.longitude),draggable:!0,map:o}),google.maps.event.addListener(t,"dragend",function(e){coords={latitude:this.getPosition().lat(),longitude:this.getPosition().lng()},getList(coords)}),t.setMap(o),google.maps.event.addListenerOnce(o,"idle",function(){$("#pac-input").fadeIn(1e3),getList(e)}),google.maps.event.addListener(o,"click",function(e){coords={latitude:e.latLng.lat(),longitude:e.latLng.lng()},getList(coords),t.setMap(null),t=new google.maps.Marker({position:new google.maps.LatLng(coords.latitude,coords.longitude),draggable:!0,map:o}),t.setMap(o),google.maps.event.addListener(t,"dragend",function(e){coords={latitude:this.getPosition().lat(),longitude:this.getPosition().lng()},getList(coords)})});var a=document.getElementById("pac-input"),n=new google.maps.places.Autocomplete(a);o.controls[google.maps.ControlPosition.TOP_LEFT].push(a),n.bindTo("bounds",o),n.addListener("place_changed",function(){t.setVisible(!1);var e=n.getPlace();if(!e.geometry)return void window.alert("No details available for input: '"+e.name+"'");e.geometry.viewport?o.fitBounds(e.geometry.viewport):(o.setCenter(e.geometry.location),o.setZoom(17)),t.setPosition(e.geometry.location),t.setVisible(!0);e.address_components&&[e.address_components[0]&&e.address_components[0].short_name||"",e.address_components[1]&&e.address_components[1].short_name||"",e.address_components[2]&&e.address_components[2].short_name||""].join(" ")})}function getList(e,t){$(".wloader").show(),$(".coords").text(e.latitude+","+e.longitude).select(),e.lang=2,$.ajax({url:WeeloApi+"user/store",type:"POST",data:e,success:function(e){loadData(e),$(".wloader").hide()},headers:requestHeaders(),dataType:"json"})}function loadData(e){null!=e.data?($("#map-country").text(e.data.country),$("#map-city").text(e.data.city),$("#map-area").text(e.data.area),$("#map-street").text(e.data.street),$("#server_msg").empty().hide(),$("#rst_data").show()):($("#rst_data").hide(),$("#server_msg").show().text(e.message)),$(".map-data").animate({opacity:1,top:"0"},300,function(){})}var coords={},coords={};init();